{% load report_extras %}
{% load static %}
<div class="modal fade" id="computerDetails">
	<div class="modal-dialog modal-lg">
		<div class="modal-content">
			<div role="tabpanel" class="modal-body" style="padding:0px;">
				<div class="row">
					<div class="col-md-3 text-center">
				  	<img src='https://km.support.apple.com.edgekey.net/kb/securedImage.jsp?configcode={{machine.serial_number|slice:"8:" }}&size=240x240' width="130" />
					</div>
				  <div class="col-md-6">
				    <h2>{% if machine.hostname %}{{ machine.hostname }}{% else %}{{ machine.serial_number }}{% endif %}</h2>
				    <h4><small>
				    {% if additional_info.model_description|length > 1 %}
				      {{ additional_info.model_description }}
				    {% else %}
				      {{ machine.machine_model }}
				    {% endif %}
				    {% if perms.reports.delete_machine and perms.manifests.delete_manifests %}
				    <a href="#" onclick="delete_machine_modal('{% if machine.hostname %}{{ machine.hostname }}{% else %}{{ machine.serial }}{% endif %}', '{{ machine.serial_number }}', '{{manifest_name}}');"><span class="glyphicon glyphicon-trash"></span></a>

				    {% endif %}
				    </small></h4>
				  </div>
				  <!-- <div class="col-md-3 hidden-xs hidden-sm hidden-print" style="text-align: right">
				    <a href="vnc://{{ user.username }}@{{ machine.hostname }}" class="btn btn-default">Screen Sharing</a>
						<a href="ssh://{{ user.username }}@{{ machine.hostname }}" class="btn btn-default">SSH</a>
				  </div> -->
				</div>
				<div>

				  <!-- Nav tabs -->
				  <ul class="nav nav-tabs" role="tablist">
				    <li role="presentation" class="active"><a href="#Software" aria-controls="Software" role="tab" data-toggle="tab">Software</a></li>
				    <li role="presentation"><a href="#AppleUpdates" aria-controls="AppleUpdates" role="tab" data-toggle="tab">Apple Updates</a></li>
				    <li role="presentation"><a href="#System" aria-controls="System" role="tab" data-toggle="tab">System</a></li>
				    <li role="presentation"><a href="#Inventory" aria-controls="Inventory" role="tab" data-toggle="tab">Inventory</a></li>
						<li role="presentation"><a href="#Staging" aria-controls="Staging" role="tab" data-toggle="tab">Staging</a></li>
				  </ul>

				  <!-- Tab panes -->
				  <div class="tab-content" id="detail_content">
						<div role="tabpanel" class="tab-pane tabDetail active" id='Software' style="overflow-x:auto; height:100%;">
							<!-- <i id="imgProgress" class="fa fa-spinner fa-pulse fa-4x"></i>-->
							<div class="container-fluid">
								<!-- Manifests / Catalog -->
								<div class="row">
									<!-- Manifests -->
									<div class='col-md-6'>
										<div class="section_label"><h4>Included Manifests</h4></div>
										<ul id='included_manifests' class='included_manifests_section list-group unstyled'>
										</ul>
									</div>

									<!-- Catalogs -->
									<div class='col-md-6'>
										<div class="section_label"><h4>Catalogs</h4></div>
										<ul id='catalogs' class='list-group unstyled'>
										</ul>
									</div>
								</div>

								<!-- Software -->
								<div class="row">
									<div class='col-md-12'>
										<div class="section_label"><h4>Software</h4></div>
											<div class="list-group list-group-root well" id='SoftwareList'>
											</div>
									</div>
								</div>
							</div>
						</div>
				    <div role="tabpanel" class="tab-pane tabDetail" id="AppleUpdates">
							<table class="table table-striped">
    						<tbody>
									{% for item in report_plist.MachineInfo.SystemProfile.0.SPInstallHistoryDataType|dictsortreversed:'install_date' %}
										{% if item.package_source == "package_source_apple"%}
										<tr><td class="text-center" style="width:25px;"><img src='{% get_static_prefix %}/img/appleupdate.png' width="20"/></td>
										<td>{{ item|get:"_name" }}</td><td>{{ item.install_version }}</td><td>{{ item.install_date|date:"d. F Y" }}</td></tr>
										{% endif %}
									{% endfor %}
								</tbody>
							</table>
						</div>
				    <div role="tabpanel" class="tab-pane tabDetail" id="System">System</div>
				    <div role="tabpanel" class="tab-pane tabDetail" id="Inventory">Inventory</div>
						<div role="tabpanel" class="tab-pane tabDetail" id="Staging">Staging</div>
				  </div>
				</div>


				<div id="data">
				</div>
			<div class="modal-footer">
				{% if perms.manifests.change_manifestfile %}
				<div class='pull-right hidden' id='save_and_cancel'>
					<button type="button" class="btn btn-danger" data-toggle="modal" data-target="#cancelEditConfirmationModal">Cancel</button>
					<button type="button" class="btn btn-success" onClick="saveManifestItem()">Save</button>
				</div>
				{% endif %}
				<div class='pull-right' id='cancel'>
					{% if not perms.pkgsinfo.change_pkginfofile %}<span class="bg-danger">You don't have permissions to make changes here.</span>{% endif %}
					<button type="button" class="btn" onClick="cancelEdit()">Cancel</button>
				</div>
			</div>
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<!--
Bootstrap modal for confirming manifest deletion
-->
<div class="modal fade" id="deleteConfirmationModal" data-backdrop="false">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">Delete manifest?</h4>
			</div>
			<div class="modal-body">
				<p>Really delete <strong>{{ pathname }}</strong>?</p>
				<p>This action cannot be undone.</p>
				<br>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" data-dismiss="modal"  onClick="deleteManifestItem()">Delete</button>
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
			</div>
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<!--
Bootstrap modal for confirming canceling editing
-->
<div class="modal fade" id="cancelEditConfirmationModal" data-backdrop="false">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">Discard your changes?</h4>
			</div>
			<div class="modal-body">
				<p>Really discard your changes to <strong>{{ pathname }}</strong>?</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-danger" data-dismiss="modal"  onClick="cancelEdit()">Discard Changes</button>
				<button type="button" class="btn btn-default" data-dismiss="modal">Continue Editing</button>
			</div>
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->
<!--
Bootstrap modal for saving or canceling when loading a different manifest
-->
<div class="modal fade" id="saveOrCancelConfirmationModal" data-backdrop="false">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<h4 class="modal-title">Save your changes?</h4>
			</div>
			<div class="modal-body">
				<p>Save your changes to <strong>{{ pathname }}</strong> before proceeding?</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-danger" data-dismiss="modal"  onClick="discardChangesAndLoadNext()">Discard Changes</button>
				<button type="button" class="btn btn-success" data-dismiss="modal" onClick="saveChangesAndLoadNext()">Save Changes</button>
			</div>
		</div><!-- /.modal-content -->
	</div><!-- /.modal-dialog -->
</div><!-- /.modal -->
