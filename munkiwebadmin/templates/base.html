<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>{{ APPNAME }} - {{ style|upper }}</title>

    {% load static %}
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href='{% get_static_prefix %}styles/{{ style }}/bootstrap.min.css' type="text/css" media="all" />

    <!-- Custom Fonts -->
    <link href="{% get_static_prefix %}fonts/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href='{% get_static_prefix %}css/jqueryui/jquery-ui.min.css' type="text/css" media="all" />

    {% block extra_style %}{% endblock %}

    <!-- static/media url for js -->
    <script>
        var static_url = "{% get_static_prefix %}";
    </script>

    <!-- jQuery -->
    <script type='text/javascript' src="{% get_static_prefix %}js/jquery.min.js"></script>
    <script type='text/javascript' src='{% get_static_prefix %}js/jquery-ui/jquery-ui.min.js'></script>
    <script type='text/javascript' src='{% get_static_prefix %}js/jqueryDataTables/jquery.dataTables.min.js'></script>
    
    <!-- Bootstrap Core JavaScript -->
    <script type='text/javascript' src="{% get_static_prefix %}js/bootstrap.min.js"></script>
    <script type='text/javascript' src='{% get_static_prefix %}js/typeahead/bootstrap3-typeahead.min.js'></script>
    <script type='text/javascript' src='{% get_static_prefix %}js/bootstrap-tabdrop.js'></script>

    {% block java_script %}{% endblock %}


    <link rel="icon" href="{% get_static_prefix %}styles/{{ style }}/favicon.ico" sizes="16x16 32x32 64x64" type="image/vnd.microsoft.icon">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  {% block body_tag %}
  <body>
  {% endblock %}
    <div id="wrapper">
      {% block main_menu %}
      <div id="site-loading-bar" class="progress" style="display: none;">
        <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
      </div>
      <!-- Navigation -->
      <nav class="navbar navbar-default navbar-fixed-top" role="navigation" style="margin-bottom: 0">
          <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                  <span class="sr-only">Toggle navigation</span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
                  <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="/"><span><img style="max-width:100px; max-height:35px; margin-top: -7px; padding-right:5px;" src="{% get_static_prefix %}styles/{{ style }}/logo.png"></span> {{APPNAME}}</a>
          </div>
          <!-- /.navbar-header -->
          <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
                <!-- /.search -->
                <form class="navbar-form navbar-left">
                    <div class="form-group has-feedback">
                    <input type="search" class="form-control" id="listSearchField" placeholder="Search" value="{{search}}">
                    </div>
                </form>
                <!-- /.dropdown -->
                {% if perms.reports.can_view_reports %}
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown">
                        <i class="fa fa-tasks fa-fw"></i>  <i class="fa fa-caret-down"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-tasks imagrInprogress">
                        <li>
                            <i id="imagrInprogressSpin" class="fa fa-circle-o-notch fa-spin text-center" style="font-size:30px"></i>
                        </li>
                    </ul>
                    <!-- /.dropdown-tasks -->
                </li>
                {% endif %}
                <!-- /.dropdown -->
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#">
                    {% if user.first_name and user.last_name %}{{ user.first_name }} {{ user.last_name }}{% else %}{{ user.username }}{% endif %} <i class="fa fa-caret-down"></i>
                    </a>
                    <ul class="dropdown-menu dropdown-user">
                        <li id="admin" class="loginlogout"><a href="/admin/" target="_blank"><i class="fa fa-gear fa-fw"></i> Admin</a></li>
                        <li class="divider"></li>
                        <li id="login" class="loginlogout">
                        {% if user.is_authenticated %}
                            <a href="/logout/"><i class="fa fa-sign-out fa-fw"></i> Logout</a>
                        {% else %}
                            <a href="/login/">Login</a>
                        {% endif %}
                        </li>
                    </ul>
                    <!-- /.dropdown-user -->
                </li>
                <li>
                    <div class="navbar-text">
                        <img alt="{{ username }}" src="{{ userImage }}" class="profile-image img-circle"/>
                    </div>
                </li>
                <!-- /.dropdown -->
            </ul>
          </div>
          <!-- /.navbar-top-links -->

          <div class="navbar-default sidebar" role="navigation">
                  <ul class="nav" id="side-menu">
                      {% if perms.reports.can_view_dashboard %}
                      <li {% if page == 'dashboard' %} class="active" {% endif %}>
                          <a href="{% url 'dashboard' %}"><i class="fa fa-tachometer fa-fw"></i> Dashboard</a>
                      </li>
                      {% endif %}
                      {% if perms.reports.can_view_reports %}
                      <li {% if page == 'reports' %} class="active" {% endif %}>
                        <a href="{% url 'reports' %}"><i class="fa fa-desktop fa-fw"></i> Computer <span class="badge pull-right">{{ SumClients }}</span></a>
                      </li>
                      {% if business_units_enabled %}
                      <li {% if page == 'reports' %} class="active" {% endif %}>
                        <a id="comp" href="{% url 'reports' %}"><i class="fa fa-building-o fa-fw"></i> Business Units <span class="badge pull-right">{{ SumClients }}</span></a>
                        <ul id="computers" class="collapse in">
                          {% for business_unit in business_units %}
                          <li>
                            <a href="{% url 'reports' %}?businessunit={{ business_unit.hash }}" {% if subpage == business_unit.hash %} class="active" {% endif %}>{{ business_unit.name }} <span class="badge pull-right">{{ business_unit.machines }}</span></a>
                          </li>
                          {% endfor %}
                          <li>
                            <a href="{% url 'reports' %}?unknown=true" {% if subpage == "unknown" %} class="active" {% endif %}>Unknown<span class="badge pull-right">{{ sumUnkown }}</span></a>
                          </li>
                        </ul>
                      </li>
                      {% endif %}
                      {% endif %}
                      {% if perms.reports.view_manifestfile %}
                      <li {% if page == 'manifests' %} class="active" {% endif %}>
                        <a href="{% url 'manifests' %}"><i class="fa fa-file-code-o fa-fw"></i> Manifests</a>
                      </li>
                      {% endif %}
                      {% if perms.reports.view_mpkginfofile %}
                      <li {% if page == 'pkgsinfo' %} class="active" {% endif %}>
                        <a href="{% url 'pkginfo' %}"><i class="fa fa-file-code-o fa-fw"></i> Package Info</a>
                      </li>
                      {% endif %}
                      {% if REPOSADOLIB and updates.view_updates %}
                      <li {% if page == 'updates' %} class="active" {% endif %}>
                        <a href="{% url 'updates' %}"><i class="fa fa-refresh fa-fw"></i> Softwareupdate</a>
                      </li>
                      {% endif %}
                  </ul>
              
              <!-- /.sidebar-collapse -->
          </div>
          
          <!-- /.navbar-static-side -->
      </nav>
      
      {% endblock %}

      <!-- Page Content -->
      <div id="page-wrapper">
        {% block content %}{% endblock %}
        <div class="clearingdiv"></div>
    </div>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="{% get_static_prefix %}js/metisMenu/metisMenu.min.js"></script>
    <script src="{% get_static_prefix %}js/munkiwebadmin.js"></script>

    {% if user.is_authenticated and perms.reports.can_view_reports %}
    <script>
    $(document).ready(function() {
        getRunningMachine();
        setInterval (function () {
            //reload imagr running machine
            getRunningMachine();
        }, 3000);
    });
    </script>
    {% endif %}
  </body>
</html>
